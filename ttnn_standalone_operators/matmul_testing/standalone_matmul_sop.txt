File:standalone_matmul.py
python standalone_matmul.py 1024 1024 1024 --num-cores 16 --dtype bfloat8_b --fidelity HiFi4 --num-runs 10 --device-id 0

Positional arguments (matrix dimensions):

1024  
This is `M`: the number of rows of matrix A. A will have shape [M, K] = [1024, 1024].

1024  
This is `K`: the number of columns of A and rows of B. A is [M, K] and B is [K, N] = [1024, 1024].

1024  
This is `N`: the number of columns of matrix B. B will have shape [K, N] = [1024, 1024], and the result C will be [M, N] = [1024, 1024].

So:

- A shape: [M, K] = [1024, 1024]  
- B shape: [K, N] = [1024, 1024]  
- C = A @ B shape: [M, N] = [1024, 1024]

Optional arguments:

--num-cores 16  
Limits the matmul to use at most 16 cores.  
- If the device has more than 16 cores, only 16 will be used.  
- If it has fewer, it will use all available cores.  
If you omit this flag, the script uses all cores by default.

--dtype bfloat8_b  
Sets the device data type for A and B to `ttnn.bfloat8_b` (a BFP8/BFLOAT8 format).  
Other allowed values in this script:  
- `bfp8`, `bfloat8_b`, `bfp8_b` → mapped to a BFP8 device dtype  
- `bf16`, `bfloat16`           → ttnn.bfloat16  
- `fp32`, `float32`            → ttnn.float32  

Host tensors are created in `torch.bfloat16` and then converted to the chosen TTNN dtype on device.

--fidelity HiFi4  
Sets the math fidelity for the compute kernel using `ttnn.WormholeComputeKernelConfig`.  
Allowed values:  
- `LoFi`  
- `HiFi2`  
- `HiFi3`  
- `HiFi4`  

In this example, `HiFi4` selects the highest math fidelity mode.

--num-runs 10  
Runs the matmul operation 10 times. The script prints progress for each run and only keeps the final output; you can change this to run more or fewer repetitions.

--device-id 0  
Opens TTNN device 0. Change this (for example, `--device-id 1`) to run the benchmark on a different Tenstorrent device if available.

Tracy profiling command (same arguments, wrapped with tracy):

python -m tracy -p -r -v standalone_matmul.py 1024 1024 1024 --num-cores 16 --dtype bfloat8_b --fidelity HiFi4 --num-runs 10 --device-id 0
